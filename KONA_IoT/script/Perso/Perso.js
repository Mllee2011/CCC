
reset();
send('00A4040000');
assertSW('9000');

auth()

//Delete
send('80E40000094F070F4B4F4E410101')

//Install
send('80E60C001B050F4B4F4E41060F4B4F4E4101070F4B4F4E410101010002C90000');
//assertSW('9000');


reset();
auth()

send('00A40400070F4B4F4E410101');
assertSW('9000');

auth();


//PUT KEY 0100
send('80 D8 00 00  27  0100  0023 003200 75991e337c985aaabf872d718f7e86a989e8290477c8d9ae20428f5b293e9b45');
//send('84 D8 01 10  27  0100  0023 003200 13E4A86E69539BA0BCFE87F18949FD5A449D782968EC8477E79E5B8FFD90B25E');

assertSW('9000');
print("0100 is OK!!");
//PUT KEY 0200
send('80 D8 00 00  48  0200 0044 100000  04 28f16705637d4d89201972ec1d4900e29749e1a8b4e9c2fb722dbef5d0704c5d2a585ef242cbf1f28db29ed8e45ec94ef9fcd0a278f034ff36206b48c72dbb62');
assertSW('9000');
print("0200 is OK!!");


//GENERATE KEYPAIR 0101 

send('80 46 00 00 27 0101 0023 003200 F1CD0AA6D2CFE7AE2893D6E8221672E892209101C35E5E6ABD8463DEA7B35949 00'); //return Public key
assertSW('9000');
print("0101 is OK!!");
//C-045c84798a3a95983b7f210227b9fa855592d304a2226ab3a70b340bedc3183fc63747d6d316caf0cb3e206376388322751b3898a4e688bce4f228646ad2c803aa 9000  

////PUT KEY 0300
////send('84 D8 03 20  39  0300 003200 6A2F5C8B31A4D9E607B1C7D44E90A3F16A2F5C8B31A4D9E607B1C7D44E90A3F16A2F5C8B31A4D9E607B1C7D44E90A3F1 FF FF FF FF');
//send('84 D8 03 20  1B  0300 0013 003200 6A2F5C8B31A4D9E607B1C7D44E90A3F1 FF FF FF FF');
//assertSW('9000');
//print("0300 is OK!!");

//STORE DATA 0700
send('80 E2 00 00  F7 0700 02C9 001032  308202c2308201aaa003020102021441f779bae728e1c388a7fc2816ad6446f9f1150b300d06092a864886f70d01010b0500304d314b3049060355040b0c42416d617a6f6e20576562205365727669636573204f3d416d617a6f6e2e636f6d20496e632e204c3d53656174746c652053543d57617368696e67746f6e20433d5553301e170d3235303532363032343531305a170d3439313233313233353935395a3052310b3009060355040613024b523113301106035504080c0a536f6d652d5374617465310e300c060355040a0c054b6f6e6169310e300c060355040b0c054b6f6e6169310e300c06035504030c05');
assertSW('9000');

send('80 E2 00 01  F0 4b6f6e61693059301306072a8648ce3d020106082a8648ce3d0301070342000428f16705637d4d89201972ec1d4900e29749e1a8b4e9c2fb722dbef5d0704c5d2a585ef242cbf1f28db29ed8e45ec94ef9fcd0a278f034ff36206b48c72dbb62a360305e301f0603551d23041830168014e6d5bc49d5d152fa62d72bdc6659afa57790eb59301d0603551d0e041604143644ac2b94cd65c0f6df8a8c2085db7942e5d441300c0603551d130101ff04023000300e0603551d0f0101ff040403020780300d06092a864886f70d01010b05000382010100110b91d5f15731fbbcfa163dbe21e6d03234f99f172f07660b06');
assertSW('9000');

send('80 E2 00 02  E6 ba909d43db0788e61127d60810a9b428d1cf9eb89c40164f29645671848548ad84dcc2e29b562518f77c6b619168c2db8528c4fa05a5a6cd6a1966c89b42cc1dae7d1d0b4a39dba1fd5bd5cfc7aaa3221d81610969a918b353f7f5fb8b94b3a549ae05e1c3432c88ab5c600aefe173ed1a28d024ae07ef6d95e7c426b5c1768bcf7bc2b852c978c3bf434ba238786058549417f1cbe51b1d94084c91f0a123e9c17ffe1623f08b776f9fbd5f199e3665d2472ee225a483acab5cf1a03405bbaa4f7baf1ca83d6a289ca22510e93b9d1be58040c87e884f416e1253880980747013bedb0355c3');
assertSW('9000');
print("0700 is OK!!");

//STORE DATA 0000 
send('80 E2 80 00 17  0000 0013 FF3200 6578616d706c652e01010101FF0000FF');
assertSW('9000');
print("0000 is OK!!");



//test
send('00A40400070F4B4F4E410101');
assertSW('9000');

//GET DATA 0701    30820137308a1dd003020102020103300a06082a8648ce3d04030230223120301e06035504030c174578616d706c6520496e7465726d656469617465204341301e170d3235303432333038303432325a170d3236303432333038303432325a30163114301206035504030c0b6578616d706c652e636f6d3059301306072a8648ce3d020106082a8648ce3d030107034200045c84798a3a95983b7f210227b9fa855592d304a2226ab3a70b340bedc3183fc63747d6d316caf0cb3e206376388322751b3898a4e688bce4f228646ad2c803aaa310300e300c0603551d130101ff04023000300a06082a8648ce3d0403020349003046022100e9a7c3114b191d22b365a5573e5a09537834252615ad41094e7168879f0c511d0221009aa94b40656a777274f6ad78a72d9ac5f6b1c602fefb1281dbc7e6270129db7b
//                 30820137308A1DD003020102020103300A06082A8648CE3D04030230223120301E06035504030C174578616D706C6520496E7465726D656469617465204341301E170D3235303432333038303432325A170D3236303432333038303432325A30163114301206035504030C0B6578616D706C652E636F6D3059301306072A8648CE3D020106082A8648CE3D030107034200045C84798A3A95983B7F210227B9FA855592D304A2226AB3A70B340BEDC3183FC63747D6D316CAF0CB3E206376388322751B3898A4E688BCE4F228646AD2C803AAA310300E300C0603551D130101FF04023000300A06082A8648CE3D0403020349003046022100E9A7C3114B191D22B365A5573E5A09537834252615AD41094E7168879F0C511D0221009AA94B40656A777274F6AD78A72D9AC5F6B1C602FEFB1281DBC7E6270129DB7B
send('80	CA	07	00 00');
assertSW('9000');

//GET DATA 0000
var res = send('80	CA	00	00 00');
if(res != '6578616D706C652E01010101FF0000FF') error ("0000 IS ERROR");