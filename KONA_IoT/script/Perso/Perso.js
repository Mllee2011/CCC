
reset();
send('00A4040000');
assertSW('9000');

auth()

//Delete
send('80E40000084F060F4B4F4E4101')

//Install
send('80E60C001B050F4B4F4E41060F4B4F4E4101070F4B4F4E410101010002C90000');
//assertSW('9000');


reset();
auth()

send('00A40400070F4B4F4E410101');
assertSW('9000');

auth();


//PUT KEY 0101
send('84 D8 01 10  2B  0101  0023 003200 6ee3c08c021471075b72021486a205286baf8cb92a3cd1094b6f3cf9c7512688  FFFFFFFF');
assertSW('9000');
print("0102 is OK!!");
//PUT KEY 0201
send('84 D8 11 10  4C  0201 0044 100000  04e55e9481b561785ab2f74d83b9ff498a665bf8114684329088d8d6a9bf6c7aa6216166fa5d4a5a90882df03b716ec67e3928fe1b58fb613ba6ecb37557e8df7e  FF FF FF FF ');
assertSW('9000');
print("0202 is OK!!");


//GENERATE KEYPAIR 0101 

send('80 46 01 11 07 0102 0023 003200 00'); //return Public key
assertSW('9000');
print("0101 is OK!!");
//C-045c84798a3a95983b7f210227b9fa855592d304a2226ab3a70b340bedc3183fc63747d6d316caf0cb3e206376388322751b3898a4e688bce4f228646ad2c803aa 9000  



//PUT KEY 0300
//send('84 D8 03 20  39  0300 003200 6A2F5C8B31A4D9E607B1C7D44E90A3F16A2F5C8B31A4D9E607B1C7D44E90A3F16A2F5C8B31A4D9E607B1C7D44E90A3F1 FF FF FF FF');
send('84 D8 03 20  1B  0300 0013 003200 6A2F5C8B31A4D9E607B1C7D44E90A3F1 FF FF FF FF');
assertSW('9000');
print("0300 is OK!!");

//STORE DATA 0710

send('80 E2 00 00  80 0701 013E 001032  30820137308a1dd003020102020103300a06082a8648ce3d04030230223120301e06035504030c174578616d706c6520496e7465726d656469617465204341301e170d3235303432333038303432325a170d3236303432333038303432325a30163114301206035504030c0b6578616 d706c652e636f6d3059');
 //                                     30820137308A1DD003020102020103300A06082A8648CE3D04030230223120301E06035504030C174578616D706C6520496E7465726D656469617465204341301E170D3235303432333038303432325A170D3236303432333038303432325A30163114301206035504030C0B6578616D706C652E636F6D3059301306072A8648CE3D020106082A8648CE3D030107034200045C84798A3A95983B7F210227B9FA855592D304A2226AB3A70B340BEDC3183FC63747D6D316CAF0CB3E206376388322751B3898A4E688BCE4F228646AD2C803AAA310300E300C0603551D130101FF04023000300A06082A8648CE3D0403020349003046022100E9A7C3114B191D22B365A5573E5A09537834252615AD41094E7168879F0C511D0221009AA94B40656A777274F6AD78A72D9AC5F6B1C602FEFB1281DBC7E6270129DB7B9000

assertSW('9000');

send('80 E2 00 01  80 301306072a8648ce3d020106082a8648ce3d030107034200045c84798a3a95983b7f210227b9fa855592d304a2226ab3a70b340bedc3183fc63747d6d316caf0cb3e206376388322751b3898a4e688bce4f228646ad2c803aaa310300e300c0603551d130101ff04023000300a06082a8648ce3d0403020349003046022100e9');
   //                  D301306072A8648CE3D020106082A8648CE3D030107034200045C84798A3A95983B7F210227B9FA855592D304A2226AB3A70B340BEDC3183FC63747D6D316CAF0CB3E206376388322751B3898A4E688BCE4F228646AD2C803AAA310300E300C0603551D130101FF04023000300A06082A8648CE3D0403020349003046022100E9A7C3114B191D22B365A5573E5A09537834252615AD41094E7168879F0C511D0221009AA94B40656A777274F6AD78A72D9AC5F6B1C602FEFB1281DBC7E6270129DB7B9000

assertSW('9000');

send('80 E2 00 02  42 a7c3114b191d22b365a5573e5a09537834252615ad41094e7168879f0c511d0221009aa94b40656a777274f6ad78a72d9ac5f6b1c602fefb1281dbc7e6270129db7b');
assertSW('9000');
print("0701 is OK!!");

//STORE DATA 0001 
send('80 E2 80 00 17  0001 0013 FF3200 6578616d706c652e01010101FF0000FF');
assertSW('9000');
print("0001 is OK!!");



//test
send('00A40400070F4B4F4E410101');
assertSW('9000');

//GET DATA 0701    30820137308a1dd003020102020103300a06082a8648ce3d04030230223120301e06035504030c174578616d706c6520496e7465726d656469617465204341301e170d3235303432333038303432325a170d3236303432333038303432325a30163114301206035504030c0b6578616d706c652e636f6d3059301306072a8648ce3d020106082a8648ce3d030107034200045c84798a3a95983b7f210227b9fa855592d304a2226ab3a70b340bedc3183fc63747d6d316caf0cb3e206376388322751b3898a4e688bce4f228646ad2c803aaa310300e300c0603551d130101ff04023000300a06082a8648ce3d0403020349003046022100e9a7c3114b191d22b365a5573e5a09537834252615ad41094e7168879f0c511d0221009aa94b40656a777274f6ad78a72d9ac5f6b1c602fefb1281dbc7e6270129db7b
//                 30820137308A1DD003020102020103300A06082A8648CE3D04030230223120301E06035504030C174578616D706C6520496E7465726D656469617465204341301E170D3235303432333038303432325A170D3236303432333038303432325A30163114301206035504030C0B6578616D706C652E636F6D3059301306072A8648CE3D020106082A8648CE3D030107034200045C84798A3A95983B7F210227B9FA855592D304A2226AB3A70B340BEDC3183FC63747D6D316CAF0CB3E206376388322751B3898A4E688BCE4F228646AD2C803AAA310300E300C0603551D130101FF04023000300A06082A8648CE3D0403020349003046022100E9A7C3114B191D22B365A5573E5A09537834252615AD41094E7168879F0C511D0221009AA94B40656A777274F6AD78A72D9AC5F6B1C602FEFB1281DBC7E6270129DB7B
send('80	CA	07	01 00');
assertSW('9000');

//GET DATA 0001
var res = send('80	CA	00	01');
if(res != '6578616D706C652E01010101FF0000FF') error ("0001 IS ERROR");


//random
send('00840000 10');
assertSW('9000');

send('00840000 08');
assertSW('9000');

send('00840000 04');
assertSW('9000');