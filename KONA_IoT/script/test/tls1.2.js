
//var sign_data = '8F9ECE13BAA1A35D687F95B3F2B26C3D16E8FF58F08B253EC75770BD7AC345114B9FE42F7438775E861099CDB9DAEF2D26FC2CC0DFC549';
var sign_data = '8F9ECE13BAA1A35D687F95B3F2B26C3D16E8FF58F08B253EC75770BD7AC345114B9FE42F7438775E861099CDB9DAEF2D26FC2CC0DFC549';

var test_sha256 = 'F1CD0AA6D2CFE7AE2893D6E8221672E892209101C35E5E6ABD8463DEA7B35949';
var test_2_sha256 = '027D20231EEA9B79DF4CA9306C03E8294D8380BABDB2C3A933CD7C996B954B18';
var test_sig = '255914066479E4A30A03E4AAC53024F21C532F5BD0992688977834DE247A56470E944AFE5A194125A27F710B717675EFD69474C0A9D37C9F6E9AE6A73EDB1BF2';
//var test_sig_der = '30   44 02 20 255914066479E4A30A03E4AAC53024F21C532F5BD0992688977834DE247A5647 02 20 0E944AFE5A194125A27F710B717675EFD69474C0A9D37C9F6E9AE6A73EDB1BF2';
//var test_sig_der = '304402204C2A3BF0DBF391F7B380B4CE55CE87DD5909F5EDEC029FBB32AD07A9E9CBF684022025440CEC38125CE7A6E33A4E181DB71EBB0FE421219F30A3B7E1722E5D8BA6DB';
//var test_sig_der_21len = '3045022100D832F3F9905AA7DAD84AF5AD51F151B003A2942034C8C4222F60102D72F98BCE022045D9DBB59E6156A6169619546271F7C47804CC804E1635541FD687DD39E74760';


var private_0100 = '75991e337c985aaabf872d718f7e86a989e8290477c8d9ae20428f5b293e9b45'; 
//var public_0100 = '04 854D3A2B6DC0DB747D88BAB93F0C569D54A9C84C5E9A2ABBF371195B7F25E59A 75B556E22F2456B29F578DE879687B633F8DA832A67B335D659451C39BB6F0C8 ';
var public_0100 = '04 28f16705637d4d89201972ec1d4900e29749e1a8b4e9c2fb722dbef5d0704c5d     2a585ef242cbf1f28db29ed8e45ec94ef9fcd0a278f034ff36206b48c72dbb62';
reset();
auth()

send('00A40400070F4B4F4E410101');
assertSW('9000');

auth();

send('00840000 20');
assertSW('9000');


//Sign
//send('802A 01 00 39 0100'+sign_data);
var res = send('802A 00 00 22 0100'+test_sha256);
//30450220749558CB7020AF7CEFB8A9322D406770404466B3414026E8D59EDE813811C722022100E6E9A5136D7950484711268A9B32C75270A740CBD2303F25213E694BD4BDFF3C 9000

// put key
send('80 D8 00 00  48  0900 0044 100000' + public_0100);
assertSW('9000');

//var res = '3045022100CC70C89C218FC60671E68B0B3CDACFBC33F8B9DC79CE3F679295D642BE6748650220278509BCD4B7AC410EDB81467584A8F71EF09A058975100F41197B07ED9C5D89';
var res = '30440220CC70C89C218FC60671E68B0B3CDACFBC33F8B9DC79CE3F679295D642BE6748650220278509BCD4B7AC410EDB81467584A8F71EF09A058975100F41197B07ED9C5D89';

//var res = '0220CC70C89C218FC60671E68B0B3CDACFBC33F8B9DC79CE3F679295D642BE6748650220278509BCD4B7AC410EDB81467584A8F71EF09A058975100F41197B07ED9C5D89';
//var res = 'CC70C89C218FC60671E68B0B3CDACFBC33F8B9DC79CE3F679295D642BE674865278509BCD4B7AC410EDB81467584A8F71EF09A058975100F41197B07ED9C5D89';



//VERIFY SIGNATURE 
//send('84200100E6 83 20 A8F2441E1036D9B5CC7A44AB5E81F03F67B7C04DBB42AC4979D3E23149D47B91 84 41 04 854D3A2B6DC0DB747D88BAB93F0C569D54A9C84C5E9A2ABBF371195B7F25E59A 75B556E22F2456B29F578DE879687B633F8DA832A67B335D659451C39BB6F0C8 85 37 '+sign_data+' 86 46'+test_sig_der);
//send('80200100CF 83 20 A8F2441E1036D9B5CC7A44AB5E81F03F67B7C04DBB42AC4979D3E23149D47B91 84 41'+public_0100+' 85 20 '+test_sha256+' 86'+toHex(res.length/2)+ res);
send('802000006E 84 02 0900'+' 85 20 '+test_sha256+' 86'+toHex(res.length/2)+ res);

//send('80200000 6c 84 02 0900'+' 85 20 '+test_sha256+' 86'+toHex(res.length/2)+ res);
//send('80200000 68 84 02 0900'+' 85 20 '+test_sha256+' 86'+toHex(res.length/2)+ res);

assertSW('9000');

